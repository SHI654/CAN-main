{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "shell",
            "label": "BUILD",
            "command": "make",
            "args": [],
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            }
        },
        {
            "type": "shell",
            "label": "FLASH",
            "command": "openocd",
            "args": [
                "-f", "C:/openocd-0.10.0/scripts/interface/cmsis-dap.cfg",  // 使用 CMSIS-DAP 接口
                "-f", "C:/openocd-0.10.0/scripts/target/stm32f1x.cfg",      // STM32F103 的配置文件
                "-c", "init",                                               // 初始化 OpenOCD
                "-c", "reset init",                                         // 复位并初始化目标设备
                "-c", "program build/CAN.elf verify",                       // 刷写并验证 ELF 文件
                "-c", "reset run",                                          // 复位并运行程序
                "-c", "shutdown"                                            // 结束 OpenOCD 会话
            ],
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            }
        },
        {
            "label": "BUILD&FLASH",
            "dependsOn": [
                "BUILD",   // 依赖编译任务
                "FLASH"    // 依赖烧录任务
            ],
            "group": {
                "kind": "build",
                "isDefault": false
            }
        }
    ]
}
